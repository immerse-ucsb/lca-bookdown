[{"path":"index.html","id":"mixture-modeling-with-mplusautomation","chapter":"Mixture Modeling with MplusAutomation","heading":"Mixture Modeling with MplusAutomation","text":" Welcome! collection resources teach apply mixture modeling using Mplus1 MplusAutomation2! resources serve comprehensive guide understanding applying LCA using Mplus automation capabilities MplusAutomation. , learn start finish apply mixture modeling using Mplus MplusAutomation package.","code":""},{"path":"index.html","id":"stay-in-touch","chapter":"Mixture Modeling with MplusAutomation","heading":"Stay in touch!","text":"Please visit website learn IMMERSE fellowship.Please visit website learn IMMERSE fellowship.Visit GitHub account access IMMERSE training materials.Visit GitHub account access IMMERSE training materials.Follow us BlueSky X stay--date fellowship!Follow us BlueSky X stay--date fellowship!","code":""},{"path":"index.html","id":"acknowledgements","chapter":"Mixture Modeling with MplusAutomation","heading":"Acknowledgements","text":"Institute Mixture Modeling Equity-Oriented Researchers, Scholars, Educators (IMMERSE) IES funded training grant (R305B220021) support education scholars integrating mixture modeling research.reference workshop: Institute Mixture Modeling Equity-Oriented Researchers, Scholars, Educators (2025).\nIMMERSE Online Resources (IES . 305B220021).\nInstitute Education Sciences.\nhttps://bookdown.org/education_immerse/lca-bookdown/","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"introduction-to-r-and-rstudio","chapter":"1 Introduction to R and RStudio","heading":"1 Introduction to R and RStudio","text":"walkthrough presented IMMERSE team go common tasks carried R.\nmany free resources available get started R RStudio.\nOne favorites R Data Science. many others!R3 free, open-source programming language environment widely used statistical computing, data analysis, data visualization.R3 free, open-source programming language environment widely used statistical computing, data analysis, data visualization.RStudio4 integrated development environment (IDE) R, providing intuitive interface makes coding, visualization, project management accessible.RStudio4 integrated development environment (IDE) R, providing intuitive interface makes coding, visualization, project management accessible.Mplus5 statistical modeling program used analyzing complex data, latent variable models, structural equation modeling, growth modeling.\nbook uses R package called MplusAutomation automate process running models, extracting results, generating data visualizations.Mplus5 statistical modeling program used analyzing complex data, latent variable models, structural equation modeling, growth modeling.\nbook uses R package called MplusAutomation automate process running models, extracting results, generating data visualizations.","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"installation","chapter":"1 Introduction to R and RStudio","heading":"1.1 Installation","text":"","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"step-0-install-r-rstudio-and-mplus","chapter":"1 Introduction to R and RStudio","heading":"1.1.1 Step 0: Install R, RStudio, and Mplus","text":"find guide installing R R Studio.\ncan also install Mplus .Note: installation Mplus requires paid license mixture add-.\nIMMERSE fellows given copy Mplus use one year training.","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"set-up","chapter":"1 Introduction to R and RStudio","heading":"1.2 Set-up","text":"","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"step-1-create-a-new-r-project-in-rstudio","chapter":"1 Introduction to R and RStudio","heading":"1.2.1 Step 1: Create a new R-project in RStudio","text":"R-projects help us organize folders , filepaths, scripts.\ncreate new R project:File –> New Project…Click “New Directory” –> New Project –> Name project","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"step-2-create-an-r-markdown-document","chapter":"1 Introduction to R and RStudio","heading":"1.2.2 Step 2: Create an R-markdown document","text":"R-markdown file provides authoring framework data science allows us organize reports using texts code chunks.\ndocument reading made using R-markdown!create R-markdown:File –> New File –> R Markdown…window pops , give R-markdown title “Introduction R RStudio” Click “OK.” see new markdown example text code chunks.\nwant clean document start delete everything line 10 .\nGo ahead save document R Project folder.","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"step-3-load-packages","chapter":"1 Introduction to R and RStudio","heading":"1.2.3 Step 3: Load packages","text":"first code chunk given markdown packages using.\ninsert code chunk, etiher use keyboard shortcut ctrl + alt + Code –> Insert Chunk click green box letter C .\npackages want markdown read :reminder, function work receive error like : find function \"random_function\"; try load package receive error like : package called `random_package` , need install package using install.packages(\"random_package\") console (bottom-left window R studio).\ninstalled package never need install , however must always load packages beginning R markdown using library(random_package), shown document.style code package using called tidyverse6 .\nfunctions within tidyverse package , ’ve indicated packages used code chunk .","code":"\nlibrary(psych) # describe()\nlibrary(here) #helps with filepaths\nlibrary(gt) # create tables\nlibrary(tidyverse) #collection of R packages designed for data science"},{"path":"introduction-to-r-and-rstudio.html","id":"explore-the-data","chapter":"1 Introduction to R and RStudio","heading":"1.3 Explore the data","text":"","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"step-4-read-in-data","chapter":"1 Introduction to R and RStudio","heading":"1.3.1 Step 4: Read in data","text":"demonstrate mixture modeling training program online resource components IES grant utilize Civil Rights Data Collection (CRDC) (CRDC) data repository.\nCRDC federally mandated school-level data collection effort occurs every year.\npublic data currently available selected latent class indicators across 4 years (2011, 2013, 2015, 2017) US states.\nexample, use Arizona state sample.\nutilize six focal indicators constitute latent class model example; three variables report harassment/bullying schools based disability, race, sex, three variables full-time equivalent school staff hires (counselor, psychologist, law enforcement).\ndata source also includes covariates variety subjects distal outcomes reported 2018 math/reading assessments graduation rates.read data R:Ways view data R:click data Global Environment (upper right pane) use…summary() gives basic summary statistics & shows number NA values (great checking data read correctly)names() provides list column names. useful don’t memorized!head() prints top 6 rows dataframe","code":"\ndata <- read_csv(here(\"data\", \"crdc_lca_data.csv\")) \nView(data)\nsummary(data)\n#>     leaid             ncessch            report_dis    \n#>  Length:2027        Length:2027        Min.   :0.0000  \n#>  Class :character   Class :character   1st Qu.:0.0000  \n#>  Mode  :character   Mode  :character   Median :0.0000  \n#>                                        Mean   :0.0425  \n#>                                        3rd Qu.:0.0000  \n#>                                        Max.   :1.0000  \n#>                                        NA's   :27      \n#>   report_race      report_sex   counselors_fte  \n#>  Min.   :0.000   Min.   :0.00   Min.   :0.0000  \n#>  1st Qu.:0.000   1st Qu.:0.00   1st Qu.:0.0000  \n#>  Median :0.000   Median :0.00   Median :0.0000  \n#>  Mean   :0.103   Mean   :0.17   Mean   :0.4595  \n#>  3rd Qu.:0.000   3rd Qu.:0.00   3rd Qu.:1.0000  \n#>  Max.   :1.000   Max.   :1.00   Max.   :1.0000  \n#>  NA's   :27      NA's   :27     NA's   :27      \n#>    psych_fte         law_fte      \n#>  Min.   :0.0000   Min.   :0.0000  \n#>  1st Qu.:0.0000   1st Qu.:0.0000  \n#>  Median :0.0000   Median :0.0000  \n#>  Mean   :0.4742   Mean   :0.1255  \n#>  3rd Qu.:1.0000   3rd Qu.:0.0000  \n#>  Max.   :1.0000   Max.   :1.0000  \n#>  NA's   :30       NA's   :27\nnames(data)\n#> [1] \"leaid\"          \"ncessch\"        \"report_dis\"    \n#> [4] \"report_race\"    \"report_sex\"     \"counselors_fte\"\n#> [7] \"psych_fte\"      \"law_fte\"\nhead(data)\n#> # A tibble: 6 × 8\n#>   leaid   ncessch      report_dis report_race report_sex\n#>   <chr>   <chr>             <dbl>       <dbl>      <dbl>\n#> 1 0400001 040000100120          0           0          0\n#> 2 0400001 040000100616          0           0          1\n#> 3 0400001 040000101204          0           0          1\n#> 4 0400001 040000101871          0           1          1\n#> 5 0400001 040000101872          0           0          0\n#> 6 0400001 040000102344          0           0          0\n#> # ℹ 3 more variables: counselors_fte <dbl>,\n#> #   psych_fte <dbl>, law_fte <dbl>"},{"path":"introduction-to-r-and-rstudio.html","id":"step-5-descriptive-statistics","chapter":"1 Introduction to R and RStudio","heading":"1.3.2 Step 5: Descriptive Statistics","text":"Let’s look descriptive statistics variable.\nlooking ID variables’ (leaid) (necessch) descriptives unnecessary, use select() remove variable using minus (-) sign:Alternatively, can use psych::describe() function give information:want look subset data?\nexample, want subset data observe specific school district?\n(leaid) can use tidyverse::filter() subset data using certain criteria.Since binary data (0,1), helpful look proportions:","code":"\ndata %>% \n  select(-leaid, -ncessch) %>% \n  summary()\n#>    report_dis      report_race      report_sex  \n#>  Min.   :0.0000   Min.   :0.000   Min.   :0.00  \n#>  1st Qu.:0.0000   1st Qu.:0.000   1st Qu.:0.00  \n#>  Median :0.0000   Median :0.000   Median :0.00  \n#>  Mean   :0.0425   Mean   :0.103   Mean   :0.17  \n#>  3rd Qu.:0.0000   3rd Qu.:0.000   3rd Qu.:0.00  \n#>  Max.   :1.0000   Max.   :1.000   Max.   :1.00  \n#>  NA's   :27       NA's   :27      NA's   :27    \n#>  counselors_fte     psych_fte         law_fte      \n#>  Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n#>  1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  \n#>  Median :0.0000   Median :0.0000   Median :0.0000  \n#>  Mean   :0.4595   Mean   :0.4742   Mean   :0.1255  \n#>  3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:0.0000  \n#>  Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n#>  NA's   :27       NA's   :30       NA's   :27\ndata %>% \n  select(-leaid, -ncessch) %>% \n  describe()\n#>                vars    n mean   sd median trimmed mad min\n#> report_dis        1 2000 0.04 0.20      0    0.00   0   0\n#> report_race       2 2000 0.10 0.30      0    0.00   0   0\n#> report_sex        3 2000 0.17 0.38      0    0.09   0   0\n#> counselors_fte    4 2000 0.46 0.50      0    0.45   0   0\n#> psych_fte         5 1997 0.47 0.50      0    0.47   0   0\n#> law_fte           6 2000 0.13 0.33      0    0.03   0   0\n#>                max range skew kurtosis   se\n#> report_dis       1     1 4.53    18.55 0.00\n#> report_race      1     1 2.61     4.82 0.01\n#> report_sex       1     1 1.76     1.08 0.01\n#> counselors_fte   1     1 0.16    -1.97 0.01\n#> psych_fte        1     1 0.10    -1.99 0.01\n#> law_fte          1     1 2.26     3.11 0.01\ndata %>% \n  filter(leaid == \"0408800\") %>% \n  describe() \n#>                vars  n  mean    sd median trimmed   mad min\n#> leaid*            1 86  1.00  0.00    1.0    1.00  0.00   1\n#> ncessch*          2 86 43.50 24.97   43.5   43.50 31.88   1\n#> report_dis        3 86  0.05  0.21    0.0    0.00  0.00   0\n#> report_race       4 86  0.15  0.36    0.0    0.07  0.00   0\n#> report_sex        5 86  0.19  0.39    0.0    0.11  0.00   0\n#> counselors_fte    6 86  0.95  0.21    1.0    1.00  0.00   0\n#> psych_fte         7 86  0.19  0.39    0.0    0.11  0.00   0\n#> law_fte           8 86  0.14  0.35    0.0    0.06  0.00   0\n#>                max range  skew kurtosis   se\n#> leaid*           1     0   NaN      NaN 0.00\n#> ncessch*        86    85  0.00    -1.24 2.69\n#> report_dis       1     1  4.23    16.10 0.02\n#> report_race      1     1  1.91     1.68 0.04\n#> report_sex       1     1  1.59     0.52 0.04\n#> counselors_fte   1     1 -4.23    16.10 0.02\n#> psych_fte        1     1  1.59     0.52 0.04\n#> law_fte          1     1  2.04     2.21 0.04\n\n\n#You can use any operator to filter: >, <, ==, >=, etc.\ndata %>% \n  drop_na() %>% \n  pivot_longer(report_dis:law_fte, names_to = \"variable\") %>% \n  group_by(variable) %>% \n  summarise(prop = sum(value)/n(),\n            n = n()) %>%\n  arrange(desc(prop))\n#> # A tibble: 6 × 3\n#>   variable         prop     n\n#>   <chr>           <dbl> <int>\n#> 1 psych_fte      0.481   1970\n#> 2 counselors_fte 0.459   1970\n#> 3 report_sex     0.173   1970\n#> 4 law_fte        0.127   1970\n#> 5 report_race    0.105   1970\n#> 6 report_dis     0.0431  1970"},{"path":"introduction-to-mplusautomation.html","id":"introduction-to-mplusautomation","chapter":"2 Introduction to MplusAutomation","heading":"2 Introduction to MplusAutomation","text":"MplusAutomation7 designed streamline use Mplus, powerful statistical software modeling complex data developed Muthen Muten (https://www.statmodel.com). MplusAutomation, researchers can automate process estimating latent variable models, running batches models, extracting results, generating data visualizations - within R environment.?MplusAutomation R packageIt “wraps around” Mplus programRequires R & Mplus softwareRequires learning basics 2 programming languagesCar metaphor: R/Rstudio steering wheel dashboard & Mplus engineWHY?MplusAutomation can provide clearly organized work procedures every research decision can documented single placeIncrease reproducibility, organization, efficiency, transparencyHOW?interface MplusAutomation entirely within R-Studio. need open MplusThe code presented repetitive designBelow template mplusObject() & mplusModeler() functions. Use template run statistical models Mplus.","code":"\nm_template  <- mplusObject(\n  \n  TITLE = \n    \"\", \n  \n  VARIABLE = \n    \"\",\n  \n  ANALYSIS = \n    \"\",\n  \n  PLOT = \n    \"\",\n  \n  OUTPUT = \n    \"\",\n \n  usevariables = colnames(), \n  rdata =  )\n\nm_template_fit <- mplusModeler(m_template, \n                  dataout=here(\"\", \".dat\"),\n                  modelout=here(\"\", \".inp\"),\n                  check=TRUE, run = TRUE, hashfilename = FALSE)"},{"path":"lca-enumeration.html","id":"lca-enumeration","chapter":"3 LCA Enumeration","heading":"3 LCA Enumeration","text":"Example: Bullying SchoolsTo demonstrate mixture modeling training program online resource components IES grant utilize Civil Rights Data Collection (CRDC)8 data repository.\nCRDC federally mandated school-level data collection effort occurs every year.\npublic data currently available selected latent class indicators across 4 years (2011, 2013, 2015, 2017) US states.\nexample, use Arizona state sample.\nutilize six focal indicators constitute latent class model example; three variables report harassment/bullying schools based disability, race, sex, three variables full-time equivalent school staff hires (counselor, psychologist, law enforcement).\ndata source also includes covariates variety subjects distal outcomes reported 2018 math/reading assessments graduation rates.Load packages","code":"\nlibrary(tidyverse)\nlibrary(haven)\nlibrary(glue)\nlibrary(MplusAutomation)\nlibrary(here)\nlibrary(janitor)\nlibrary(gt)\nlibrary(cowplot)\nlibrary(DiagrammeR) "},{"path":"lca-enumeration.html","id":"variable-description","chapter":"3 LCA Enumeration","heading":"3.1 Variable Description","text":"Variables transformed dichotomous indicators using following coding strategyHarassment bullying count variables recoded 1 school reported least one incident harassment (0 indicates reported incidents).\noriginal scale reported CDRC staff variables full time equivalent employees (FTE) represented 1 part time employees represented values 1 0.\nSchools greater one staff designated type represented values greater 1.\nvalues greater zero recorded 1s (e.g., .5, 1,3) indicating school staff present campus least part time.\nSchools staff designated type indicated 0 dichotomous variable.","code":""},{"path":"lca-enumeration.html","id":"prepare-data","chapter":"3 LCA Enumeration","heading":"3.2 Prepare Data","text":"","code":"\ndf_bully <- read_csv(here(\"data\", \"crdc_lca_data.csv\")) %>% \n  clean_names() %>% \n  dplyr::select(report_dis, report_race, report_sex, counselors_fte, psych_fte, law_fte) "},{"path":"lca-enumeration.html","id":"descriptive-statistics","chapter":"3 LCA Enumeration","heading":"3.3 Descriptive Statistics","text":"Save image","code":"\n# Set up data to find proportions of binary indicators\nds <- df_bully %>% \n  pivot_longer(c(report_dis, report_race, report_sex, counselors_fte, psych_fte, law_fte), names_to = \"variable\") \n\n\n# Create table of variables and counts, then find proportions and round to 3 decimal places\nprop_df <- ds %>%\n  count(variable, value) %>%\n  group_by(variable) %>%\n  mutate(prop = n / sum(n)) %>%\n  ungroup() %>%\n  mutate(prop = round(prop, 3))\n\n\n# Make it a gt() table\nprop_table <- prop_df %>% \n  gt(groupname_col = \"variable\", rowname_col = \"value\") %>%\n  tab_stubhead(label = md(\"*Values*\")) %>%\n  tab_header(\n    md(\n      \"Variable Proportions\"\n    )\n  ) %>%\n  cols_label(\n    variable = md(\"*Variable*\"),\n    value = md(\"*Value*\"),\n    n = md(\"*N*\"),\n    prop = md(\"*Proportion*\")\n  ) \n  \nprop_table\ngtsave(prop_table, here(\"figures\", \"prop_table.png\"))"},{"path":"lca-enumeration.html","id":"enumeration","chapter":"3 LCA Enumeration","heading":"3.4 Enumeration","text":"code uses mplusObject function MplusAutomation package saves model runs enum folder.IMPORTANT: moving forward, make sure open output document ensure models estimated normally.","code":"\n\nlca_6  <- lapply(1:6, function(k) {\n  lca_enum  <- mplusObject(\n      \n    TITLE = glue(\"{k}-Class\"), \n  \n    VARIABLE = glue(\n    \"categorical = report_dis-law_fte; \n     usevar = report_dis-law_fte;\n     classes = c({k}); \"),\n  \n  ANALYSIS = \n   \"estimator = mlr; \n    type = mixture;\n    starts = 200 100; \n    processors = 10;\",\n  \n  OUTPUT = \"sampstat residual tech11 tech14;\",\n  \n  PLOT = \n    \"type = plot3; \n    series = report_dis-law_fte(*);\",\n  \n  usevariables = colnames(df_bully),\n  rdata = df_bully)\n\nlca_enum_fit <- mplusModeler(lca_enum, \n                            dataout=glue(here(\"enum\", \"bully.dat\")),\n                            modelout=glue(here(\"enum\", \"c{k}_bully.inp\")) ,\n                            check=TRUE, run = TRUE, hashfilename = FALSE)\n})"},{"path":"lca-enumeration.html","id":"table-of-fit","chapter":"3 LCA Enumeration","heading":"3.5 Table of Fit","text":"First, extract data:, create table:Save table","code":"\n# \noutput_bully <- readModels(here(\"enum\"), filefilter = \"bully\", quiet = TRUE)\n\nenum_extract <- LatexSummaryTable(\n  output_bully,\n  keepCols = c(\n    \"Title\",\n    \"Parameters\",\n    \"LL\",\n    \"BIC\",\n    \"aBIC\",\n    \"BLRT_PValue\",\n    \"T11_VLMR_PValue\",\n    \"Observations\"\n  ),\n  sortBy = \"Title\"\n) \n\n\nallFit <- enum_extract %>%\n  mutate(CAIC = -2 * LL + Parameters * (log(Observations) + 1)) %>%\n  mutate(AWE = -2 * LL + 2 * Parameters * (log(Observations) + 1.5)) %>%\n  mutate(SIC = -.5 * BIC) %>%\n  mutate(expSIC = exp(SIC - max(SIC))) %>%\n  mutate(BF = exp(SIC - lead(SIC))) %>%\n  mutate(cmPk = expSIC / sum(expSIC)) %>%\n  dplyr::select(1:5, 9:10, 6:7, 13, 14) %>%\n  arrange(Parameters)\nfit_table1 <- allFit %>%\n  gt() %>%\n  tab_header(title = md(\"**Model Fit Summary Table**\")) %>%\n  cols_label(\n    Title = \"Classes\",\n    Parameters = md(\"Par\"),\n    LL = md(\"*LL*\"),\n    T11_VLMR_PValue = \"VLMR\",\n    BLRT_PValue = \"BLRT\",\n    BF = md(\"BF\"),\n    cmPk = md(\"*cmPk*\")\n  ) %>%\n  tab_footnote(\n    footnote = md(\n      \"*Note.* Par = Parameters; *LL* = model log likelihood;\nBIC = Bayesian information criterion;\naBIC = sample size adjusted BIC; CAIC = consistent Akaike information criterion;\nAWE = approximate weight of evidence criterion;\nBLRT = bootstrapped likelihood ratio test p-value;\nVLMR = Vuong-Lo-Mendell-Rubin adjusted likelihood ratio test p-value;\n*cmPk* = approximate correct model probability.\"\n    ),\nlocations = cells_title()\n  ) %>%\n  tab_options(column_labels.font.weight = \"bold\") %>%\n  fmt_number(c(3:7),\n             decimals = 2) %>%\n  sub_missing(1:11,\n              missing_text = \"--\") %>%\n  fmt(\n    c(8:9, 11),\n    fns = function(x)\n      ifelse(x < 0.001, \"<.001\",\n             scales::number(x, accuracy = .01))\n  ) %>%\n  fmt(\n    10,\n    fns = function (x)\n      ifelse(x > 100, \">100\",\n             scales::number(x, accuracy = .01))\n  ) %>%  \n  tab_style(\n    style = list(\n      cell_text(weight = \"bold\")\n      ),\n    locations = list(cells_body(\n     columns = BIC,\n     row = BIC == min(BIC[c(1:6)]) # Change this to the number of classes you are evaluating\n    ),\n    cells_body(\n     columns = aBIC,\n     row = aBIC == min(aBIC[1:6])\n    ),\n    cells_body(\n     columns = CAIC,\n     row = CAIC == min(CAIC[1:6])\n    ),\n    cells_body(\n     columns = AWE,\n     row = AWE == min(AWE[1:6])\n    ),\n    cells_body(\n     columns = cmPk,\n     row =  cmPk == max(cmPk[1:6])\n     ),    \n    cells_body(\n     columns = BF,\n     row =  BF > 10),\n    cells_body( \n     columns =  T11_VLMR_PValue,\n     row =  ifelse(T11_VLMR_PValue < .05 & lead(T11_VLMR_PValue) > .05, T11_VLMR_PValue < .05, NA)),\n    cells_body(\n     columns =  BLRT_PValue,\n     row =  ifelse(BLRT_PValue < .05 & lead(BLRT_PValue) > .05, BLRT_PValue < .05, NA))\n  )\n)\n\nfit_table1\ngtsave(fit_table1, here(\"figures\", \"fit_table.png\"))"},{"path":"lca-enumeration.html","id":"information-criteria-plot","chapter":"3 LCA Enumeration","heading":"3.6 Information Criteria Plot","text":"Save figure","code":"\nallFit %>%\n  dplyr::select(2:7) %>%\n  rowid_to_column() %>%\n  pivot_longer(`BIC`:`AWE`,\n               names_to = \"Index\",\n               values_to = \"ic_value\") %>%\n  mutate(Index = factor(Index,\n                        levels = c (\"AWE\", \"CAIC\", \"BIC\", \"aBIC\"))) %>%\n  ggplot(aes(\n    x = rowid,\n    y = ic_value,\n    color = Index,\n    shape = Index,\n    group = Index,\n    lty = Index\n  )) +\n  geom_point(size = 2.0) + geom_line(linewidth = .8) +\n  scale_x_continuous(breaks = 1:nrow(allFit)) +\n  scale_colour_grey(end = .5) +\n  theme_cowplot() +\n  labs(x = \"Number of Classes\", y = \"Information Criteria Value\", title = \"Information Criteria\") +\n  theme(\n    text = element_text(family = \"serif\", size = 12),\n    legend.text = element_text(family=\"serif\", size=12),\n    legend.key.width = unit(3, \"line\"),\n    legend.title = element_blank(),\n    legend.position = \"top\"  \n  )\nggsave(here(\"figures\", \"info_criteria.png\"), dpi=300, height=5, width=7, units=\"in\")"},{"path":"lca-enumeration.html","id":"compare-class-solutions","chapter":"3 LCA Enumeration","heading":"3.7 Compare Class Solutions","text":"Compare probability plots \\(K = 1:6\\) class solutionsSave figure:","code":"\nmodel_results <- data.frame()\n\nfor (i in 1:length(output_bully)) {\n  \n  temp <- output_bully[[i]]$parameters$probability.scale %>%                                       \n    mutate(model = paste(i,\"-Class Model\"))                                                  \n  \n  model_results <- rbind(model_results, temp)\n}\n\nrm(temp)\n\ncompare_plot <-\n  model_results %>%\n  filter(category == 2) %>%\n  dplyr::select(est, model, LatentClass, param) %>%\n  mutate(param = as.factor(str_to_lower(param))) \n\ncompare_plot$param <- fct_inorder(compare_plot$param)\n\nggplot(\n  compare_plot,\n  aes(\n    x = param,\n    y = est,\n    color = LatentClass,\n    shape = LatentClass,\n    group = LatentClass,\n    lty = LatentClass\n  )\n) +\n  geom_point() + \n  geom_line() +\n  scale_colour_viridis_d() +\n  facet_wrap( ~ model, ncol = 2) +\n  labs(title = \"Bullying Items\",\n       x = \" \", y = \"Probability\") +\n  theme_minimal() +\n  theme(panel.grid.major.y = element_blank(),\n                          axis.text.x = element_text(angle = -45, hjust = -.1))                            \nggsave(here(\"figures\", \"compare_kclass_plot.png\"), dpi=300, height=5, width=7, units=\"in\")"},{"path":"lca-enumeration.html","id":"class-probability-plot","chapter":"3 LCA Enumeration","heading":"3.8 3-Class Probability Plot","text":"Use plot_lca function provided folder plot item probability plot. function requires one argument:\n- model_name: name Mplus readModels object (e.g., output_bully$c3_bully.)Save figure:","code":"\nsource(\"plot_lca.txt\")\n\nplot_lca(model_name = output_bully$c3_bully.out)\nggsave(here(\"figures\", \"C3_bully_LCA_Plot.png\"), dpi=\"retina\", height=5, width=7, units=\"in\")"},{"path":"lca-enumeration.html","id":"observed-response-patterns","chapter":"3 LCA Enumeration","heading":"3.9 Observed Response Patterns","text":"Save response frequencies 3-class model previous lab response _____.dat SAVEDATA.Read observed response pattern data relabel columnsCreate table top 5 unconditional response pattern, top conditional response pattern modal class assignmentFinally, use gt make nicely formatted tableSave table:","code":"\n\npatterns  <- mplusObject(\n  \n  TITLE = \"C3 LCA - Save response patterns\", \n  \n  VARIABLE = \n  \"categorical = report_dis-law_fte; \n   usevar =  report_dis-law_fte;\n   classes = c(3);\",\n  \n  ANALYSIS = \n   \"estimator = mlr; \n    type = mixture;\n    starts = 0;\n    processors = 10;\n    optseed = 802779;\",\n  \n  SAVEDATA = \n   \"File=savedata.dat;\n    Save=cprob;\n    \n    ! Code to save response frequency data \n    \n    response is resp_patterns.dat;\",\n  \n  OUTPUT = \"residual patterns tech11 tech14\",\n  \n  usevariables = colnames(df_bully),\n  rdata = df_bully)\n\npatterns_fit <- mplusModeler(patterns,\n                dataout=here(\"mplus\", \"bully.dat\"),\n                modelout=here(\"mplus\", \"patterns.inp\") ,\n                check=TRUE, run = TRUE, hashfilename = FALSE)\n# Read in response frequency data that we just created:\npatterns <- read_table(here(\"mplus\", \"resp_patterns.dat\"),\n                        col_names=FALSE, na = \"*\") \n\n# Extract the column names\nnames <- names(readModels(here(\"mplus\", \"patterns.out\"))[['savedata']]) \n\n# Add the names back to the dataset\ncolnames(patterns) <- c(\"Frequency\", names)  \n# Order responses by highest frequency\norder_highest <- patterns %>% \n  arrange(desc(Frequency)) \n\n# Loop `patterns` data to list top 5 conditional response patterns for each class\nloop_cond  <- lapply(1:max(patterns$C), function(k) {       \norder_cond <- patterns %>%                    \n  filter(C == k) %>%                    \n  arrange(desc(Frequency)) %>%                \n  head(5)                                     \n  })                                          \n\n# Convert loop into data frame\ntable_data <- as.data.frame(bind_rows(loop_cond))\n\n# Combine unconditional and conditional responses patterns\nresponse_patterns <-  rbind(order_highest[1:5,], table_data) \nresp_table <- response_patterns %>% \n  gt() %>%\n    tab_header(\n    title = \"Observed Response Patterns\",\n    subtitle = html(\"Response patterns, estimated frequencies, estimated posterior class probabilities and modal assignments\")) %>% \n    tab_source_note(\n    source_note = md(\"Data Source: **Civil Rights Data Collection (CRDC)**\")) %>%\n    cols_label(\n      Frequency = html(\"<i>f<\/i><sub>r<\/sub>\"),\n    REPORT_D = \"Harrassment: Disability\",\n    REPORT_R = \"Harrassment: Race\",\n    REPORT_S = \"Harrassment: Sex\",\n    COUNSELO = \"Staff: Counselor\",\n    PSYCH_FT = \"Staff: Psychologist\",\n    LAW_FTE = \"Staff: Law Enforcement\",\n    CPROB1 = html(\"P<sub><i>k<\/i><\/sub>=1\"),\n    CPROB2 = html(\"P<sub><i>k<\/i><\/sub>=2\"),\n    CPROB3 = html(\"P<sub><i>k<\/i><\/sub>=3\"),\n    C = md(\"*k*\")) %>% \n  tab_row_group(\n    label = \"Unconditional response patterns\",\n    rows = 1:5) %>%\n  tab_row_group(\n    label = md(\"*k* = 1 Conditional response patterns\"),\n    rows = 6:10) %>% #EDIT THESE VALUES BASED ON THE LAST COLUMN\n  tab_row_group(\n    label = md(\"*k* = 2 Conditional response patterns\"),\n    rows = 11:15)  %>% #EDIT THESE VALUES BASED ON THE LAST COLUMN\n  tab_row_group(\n    label = md(\"*k* = 3 Conditional response patterns\"),\n    rows = 16:20)  %>% #EDIT THESE VALUES BASED ON THE LAST COLUMN  \n    row_group_order(\n      groups = c(\"Unconditional response patterns\",\n                 md(\"*k* = 1 Conditional response patterns\"),\n                 md(\"*k* = 2 Conditional response patterns\"),\n                 md(\"*k* = 3 Conditional response patterns\"))) %>% \n    tab_footnote(\n    footnote = html(\n      \"<i>Note.<\/i> <i>f<\/i><sub>r<\/sub> = response pattern frequency; P<sub><i>k<\/i><\/sub> = posterior class probabilities\"\n    )\n  ) %>% \n  cols_align(align = \"center\") %>% \n  opt_align_table_header(align = \"left\") %>% \n  gt::tab_options(table.font.names = \"Times New Roman\")\n\nresp_table\ngtsave(resp_table, here(\"figures\",\"resp_table.png\"))"},{"path":"lca-enumeration.html","id":"classification-diagnostics","chapter":"3 LCA Enumeration","heading":"3.10 Classification Diagnostics","text":"Use Mplus calculate k-class confidence intervals (Note: Change synax make chosen k-class model):Note: Ensure classes shift step (.g., Class 1 enumeration run now Class 4). Evaluate output compare class counts proportions latent classes. Using OPTSEED function ensures replication best loglikelihood value run.Read 3-class model:Now, use gt make nicely formatted table","code":"\nclassification  <- mplusObject(\n  \n  TITLE = \"C3 LCA - Calculated k-Class 95% CI\",\n  \n  VARIABLE =\n    \"categorical = report_dis-law_fte;\n   usevar =  report_dis-law_fte;\n   classes = c(3);\", \n  \n  ANALYSIS =\n    \"estimator = ml;\n    type = mixture;\n    starts = 0; \n    processors = 10;\n    optseed = 802779;\n    bootstrap = 1000;\",\n  \n  MODEL =\n    \"\n  !CHANGE THIS SECTION TO YOUR CHOSEN k-CLASS MODEL\n    \n  %OVERALL%\n  [C#1](c1);\n  \n  [C#2](C2);\n\n  Model Constraint:\n  New(p1 p2 p3);\n  \n  p1 = exp(c1)/(1+exp(c1)+exp(c2));\n  p2 = exp(c2)/(1+exp(c1)+exp(c2));\n  p3 = 1/(1+exp(c1)+exp(c2));\",\n\n  \n  OUTPUT = \"cinterval(bcbootstrap)\",\n  \n  usevariables = colnames(df_bully),\n  rdata = df_bully)\n\nclassification_fit <- mplusModeler(classification,\n                dataout=here(\"mplus\", \"bully.dat\"),\n                modelout=here(\"mplus\", \"class.inp\") ,\n                check=TRUE, run = TRUE, hashfilename = FALSE)\n# Read in the 3-class model and extract information needed\noutput_bully <- readModels(here(\"mplus\", \"class.out\"))\n\n# Entropy\nentropy <- c(output_bully$summaries$Entropy, rep(NA, output_bully$summaries$NLatentClasses-1))\n\n# 95% k-Class and k-class 95% Confidence Intervals\nk_ci <- output_bully$parameters$ci.unstandardized %>% \n  filter(paramHeader == \"New.Additional.Parameters\") %>% \n  unite(CI, c(low2.5,up2.5), sep=\", \", remove = TRUE) %>% \n  mutate(CI = paste0(\"[\", CI, \"]\")) %>% \n  rename(kclass=est) %>% \n  dplyr::select(kclass, CI)\n\n# AvePPk = Average Latent Class Probabilities for Most Likely Latent Class Membership (Row) by Latent Class (Column)\navePPk <- tibble(avePPk = diag(output_bully$class_counts$avgProbs.mostLikely))\n\n# mcaPk = modal class assignment proportion \nmcaPk <- round(output_bully$class_counts$mostLikely,3) %>% \n  mutate(model = paste0(\"Class \", class)) %>% \n  add_column(avePPk, k_ci) %>% \n  rename(mcaPk = proportion) %>% \n  dplyr::select(model, kclass, CI, mcaPk, avePPk)\n\n# OCCk = odds of correct classification\nOCCk <- mcaPk %>% \n  mutate(OCCk = round((avePPk/(1-avePPk))/(kclass/(1-kclass)),3))\n\n# Put everything together\nclass_table <- data.frame(OCCk, entropy)\nclass_table <- class_table %>% \n  gt() %>%\n    tab_header(\n    title = \"Model Classification Diagnostics for the 3-Class Solution\") %>%\n    cols_label(\n      model = md(\"*k*-Class\"),\n      kclass = md(\"*k*-Class Proportions\"),\n      CI = \"95% CI\",\n      mcaPk = html(\"McaP<sub>k<\/sub>\"),\n      avePPk = md(\"AvePP<sub>k<\/sub>\"),\n      OCCk = md(\"OCC<sub>k<\/sub>\"),\n      entropy = \"Entropy\") %>% \n    sub_missing(7,\n              missing_text = \"\") %>%\n    tab_footnote(\n    footnote = html(\n      \"<i>Note.<\/i> McaP<sub>k<\/sub> = Modal class assignment proportion; AvePP<sub>k<\/sub> = Average posterior class probabilities; OCC<sub>k<\/sub> = Odds of correct classification; \"\n    )\n  ) %>% \n  cols_align(align = \"center\") %>% \n  opt_align_table_header(align = \"left\") %>% \n  gt::tab_options(table.font.names = \"Times New Roman\")\n\nclass_table"},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
